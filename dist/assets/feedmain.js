import{r as c,h as p,j as s,S as w,N as f,P as h,a as x,b as S,c as v}from"./index.js";import{s as d,E as m}from"./effect-coverflow.js";function j({images:o}){const l=c.useRef(null);c.useEffect(()=>{const e=n=>{if(S.includes(n.origin)){const{action:a,scene:t}=n.data;if(a==="changeSlide"&&!isNaN(t)){const r=l.current.swiper,i=o[t-1];i&&window.parent.postMessage({url:i.url,title:i.title,explanation:i.explanation,source:"feedmain"},"*"),t>0&&t<=18&&l.current?r.slideToLoop(t-1):r.slideToLoop(0)}}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[o]);const u=(e,n,a,t,r)=>{const i=e+1;console.log("Slide clicked, real index:",i),l.current.swiper&&l.current.swiper.slideToLoop(e),window.parent.postMessage({index:i,url:n,title:a,explanation:t,mediaType:r,source:"feedmain"},"*")};return c.useEffect(()=>{p()},[o]),s.jsx("div",{className:d.swiperContainer,children:s.jsx(w,{effect:"slide",grabCursor:!0,loop:o.length>3,centeredSlides:!0,slidesPerView:"auto",modules:[f,h],spaceBetween:0,navigation:!0,pagination:{clickable:!0},className:d.mySwiper,slidesPerGroup:1,ref:l,children:o.map((e,n)=>s.jsx(x,{className:d.swiperSlide,onClick:()=>u(n,e.url,e.title,e.explanation,e.media_type),children:s.jsxs("a",{href:"#",onClick:a=>a.preventDefault(),children:[e.media_type==="video"?s.jsx("iframe",{src:e.url,title:e.title,allowFullScreen:!0}):s.jsx("img",{src:e.url,alt:e.title||"Slide Image"}),s.jsx("p",{children:e.title})]})},n))})})}function E({images:o}){const l=c.useRef(null);c.useEffect(()=>{const e=n=>{if(S.includes(n.origin)){const{action:a,scene:t}=n.data;if(a==="changeSlide"&&!isNaN(t)){const r=l.current.swiper,i=o[t-1];i&&window.parent.postMessage({url:i.url,title:i.title,explanation:i.explanation,source:"feedmain"},"*"),t>0&&t<=18&&l.current?r.slideToLoop(t-1):r.slideToLoop(0)}}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[o]);const u=(e,n,a,t,r)=>{const i=e+1;console.log("Slide clicked, real index:",i),l.current.swiper&&l.current.swiper.slideToLoop(e),window.parent.postMessage({index:i,url:n,title:a,explanation:t,mediaType:r,source:"feedmain"},"*")};return c.useEffect(()=>{p()},[o]),s.jsx("div",{className:d.swiperContainer,children:s.jsx(w,{effect:"coverflow",grabCursor:!0,loop:o.length>3,centeredSlides:!0,slidesPerView:"auto",coverflowEffect:{rotate:40,stretch:0,depth:100,modifier:1,slideShadows:!1},modules:[m,f,h],spaceBetween:50,navigation:!0,pagination:{clickable:!0},className:d.mySwiper,slidesPerGroup:1,ref:l,children:o.map((e,n)=>s.jsx(x,{className:d.swiperSlide,onClick:()=>u(n,e.url,e.title,e.explanation,e.media_type),children:s.jsxs("a",{href:"#",onClick:a=>a.preventDefault(),children:[e.media_type==="video"?s.jsx("iframe",{src:e.url,title:e.title,allowFullScreen:!0}):s.jsx("img",{src:e.url,alt:e.title||"Slide Image"}),s.jsx("p",{children:e.title})]})},n))})})}function k(){const[o,l]=c.useState(window.innerWidth<800),[u,e]=c.useState([]),[n,a]=c.useState(!1);return c.useEffect(()=>{const t=()=>a(window.parent.document.body.classList.contains("dark"));t();const r=new MutationObserver(t);return r.observe(window.parent.document.body,{attributes:!0,attributeFilter:["class"]}),()=>r.disconnect()},[]),c.useEffect(()=>{const t=()=>l(window.innerWidth<800);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),c.useEffect(()=>{(async()=>{try{const r=await fetch("https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY&hd=True&count=18");if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const i=await r.json();e(i)}catch(r){console.error("Failed to fetch images: "+r)}})()},[]),s.jsx("div",{className:`${n?d.dark:""}`,children:o?s.jsx(j,{images:u}):s.jsx(E,{images:u})})}v(document.getElementById("root")).render(s.jsx(c.StrictMode,{children:s.jsx(k,{})}));
