import{r as a,h as p,j as r,S as w,N as f,P as h,a as x,b as S,c as m}from"./index.js";import{s as d,E as v}from"./effect-coverflow.js";function j({images:i}){const l=a.useRef(null);a.useEffect(()=>{const e=s=>{if(S.includes(s.origin)){const{action:c,scene:t}=s.data;if(c==="changeSlide"&&!isNaN(t)){const o=l.current.swiper,n=i[t-1];n&&window.parent.postMessage({url:n.url,title:n.title,explanation:n.explanation,source:"feedmain"},"*"),t>0&&t<=18&&l.current?o.slideToLoop(t-1):o.slideToLoop(0)}}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[i]);const u=(e,s,c,t,o)=>{const n=e+1;console.log("Slide clicked, real index:",n),l.current.swiper&&l.current.swiper.slideToLoop(e),window.parent.postMessage({index:n,url:s,title:c,explanation:t,source:"feedmain"},"*")};return a.useEffect(()=>{p()},[i]),r.jsx("div",{className:d.swiperContainer,children:r.jsx(w,{effect:"slide",grabCursor:!0,loop:i.length>3,centeredSlides:!0,slidesPerView:"auto",modules:[f,h],spaceBetween:0,navigation:!0,pagination:{clickable:!0},className:d.mySwiper,slidesPerGroup:1,ref:l,children:i.map((e,s)=>r.jsx(x,{className:d.swiperSlide,onClick:()=>u(s,e.url,e.title,e.explanation,e.media_type),children:r.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:[e.media_type==="video"?r.jsx("iframe",{src:e.url,title:e.title,allowFullScreen:!0}):r.jsx("img",{src:e.url,alt:e.title||"Slide Image"}),r.jsx("p",{children:e.title})]})},s))})})}function E({images:i}){const l=a.useRef(null);a.useEffect(()=>{const e=s=>{if(S.includes(s.origin)){const{action:c,scene:t}=s.data;if(c==="changeSlide"&&!isNaN(t)){const o=l.current.swiper,n=i[t-1];n&&window.parent.postMessage({url:n.url,title:n.title,explanation:n.explanation,source:"feedmain"},"*"),t>0&&t<=18&&l.current?o.slideToLoop(t-1):o.slideToLoop(0)}}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[i]);const u=(e,s,c,t,o)=>{const n=e+1;console.log("Slide clicked, real index:",n),l.current.swiper&&l.current.swiper.slideToLoop(e),window.parent.postMessage({index:n,url:s,title:c,explanation:t,source:"feedmain"},"*")};return a.useEffect(()=>{p()},[i]),r.jsx("div",{className:d.swiperContainer,children:r.jsx(w,{effect:"coverflow",grabCursor:!0,loop:i.length>3,centeredSlides:!0,slidesPerView:"auto",coverflowEffect:{rotate:40,stretch:0,depth:100,modifier:1,slideShadows:!1},modules:[v,f,h],spaceBetween:50,navigation:!0,pagination:{clickable:!0},className:d.mySwiper,slidesPerGroup:1,ref:l,children:i.map((e,s)=>r.jsx(x,{className:d.swiperSlide,onClick:()=>u(s,e.url,e.title,e.explanation,e.media_type),children:r.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:[e.media_type==="video"?r.jsx("iframe",{src:e.url,title:e.title,allowFullScreen:!0}):r.jsx("img",{src:e.url,alt:e.title||"Slide Image"}),r.jsx("p",{children:e.title})]})},s))})})}function k(){const[i,l]=a.useState(window.innerWidth<800),[u,e]=a.useState([]),[s,c]=a.useState(!1);return a.useEffect(()=>{const t=()=>c(window.parent.document.body.classList.contains("dark"));t();const o=new MutationObserver(t);return o.observe(window.parent.document.body,{attributes:!0,attributeFilter:["class"]}),()=>o.disconnect()},[]),a.useEffect(()=>{const t=()=>l(window.innerWidth<800);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),a.useEffect(()=>{(async()=>{try{const o=await fetch("https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY&hd=True&count=18");if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const n=await o.json();e(n)}catch(o){console.error("Failed to fetch images: "+o)}})()},[]),r.jsx("div",{className:`${s?d.dark:""}`,children:i?r.jsx(j,{images:u}):r.jsx(E,{images:u})})}m(document.getElementById("root")).render(r.jsx(a.StrictMode,{children:r.jsx(k,{})}));
